{"version":3,"sources":["webpack:///Editor.js","webpack:///webpack/bootstrap 70b1a6600bfa0a9cf61a","webpack:///./src/scripts/app/EditorUI.coffee","webpack:///external \"TweenTime.Editor\"","webpack:///external \"d3\""],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","__WEBPACK_AMD_DEFINE_RESULT__","__bind","fn","me","apply","arguments","require","EditorUI","THREE","TweenTimeEditor","d3","window","this","initAdd","initRemove","onMenuCreated","$container","getRaycaster","mouse","offset","plane","projector","selectedObject","selectedObjectPos","tweenTime","editor","json_replacer","key","val","$","app","containerWebgl","Vector3","Projector","Vector2","Mesh","PlaneBufferGeometry","MeshBasicMaterial","color","opacity","transparent","visible","_this","camera","raycaster","vector","activeCamera","x","y","unproject","Raycaster","position","sub","normalize","mousedown","e","element","intersects","preventDefault","intersectObjects","scene","children","length","object","_data","selectionManager","select","clone","intersectObject","copy","point","mouseup","mousemove","pos","posDiff","prop_x","prop_y","clientX","width","clientY","height","getProperty","add","setValue","_isDirty","timeline","prototype","$el","append","prepend","data","self","find","click","datum","index","item","_i","_len","_ref","selection","indexOf","type","splice","destroy","reset","render","$link","element_name","elements","ElementFactory","all_data","current_time","label","next_id","timer","time","isDirty","start","end","collapsed","properties","getTypeProperties","push","undefined","TweenTime","Editor"],"mappings":"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","file":"Editor.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"assets/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_RESULT__;var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\t\n\t!(__WEBPACK_AMD_DEFINE_RESULT__ = function(require) {\n\t  var EditorUI, THREE, TweenTimeEditor, d3;\n\t  THREE = window.THREE;\n\t  TweenTimeEditor = __webpack_require__(3);\n\t  d3 = __webpack_require__(4);\n\t  return window.EditorUI = EditorUI = (function() {\n\t    function EditorUI() {\n\t      this.initAdd = __bind(this.initAdd, this);\n\t      this.initRemove = __bind(this.initRemove, this);\n\t      this.onMenuCreated = __bind(this.onMenuCreated, this);\n\t      var $container, getRaycaster, mouse, offset, plane, projector, selectedObject, selectedObjectPos;\n\t      this.tweenTime = window.tweenTime;\n\t      this.editor = new TweenTimeEditor(this.tweenTime, {\n\t        json_replacer: function(key, val) {\n\t          if (key === 'container') {\n\t            return void 0;\n\t          }\n\t          if (key === 'parent') {\n\t            return void 0;\n\t          }\n\t          if (key === 'children') {\n\t            return void 0;\n\t          }\n\t          if (key === 'object') {\n\t            return void 0;\n\t          }\n\t          if (key === 'classObject') {\n\t            return void 0;\n\t          }\n\t          return val;\n\t        }\n\t      });\n\t      this.onMenuCreated($('.timeline__menu'));\n\t      $container = $(window.app.containerWebgl);\n\t      offset = new THREE.Vector3();\n\t      projector = new THREE.Projector();\n\t      mouse = new THREE.Vector2();\n\t      selectedObject = false;\n\t      selectedObjectPos = new THREE.Vector3();\n\t      plane = new THREE.Mesh(new THREE.PlaneBufferGeometry(3000, 2000, 8, 8), new THREE.MeshBasicMaterial({\n\t        color: 0xff0000,\n\t        opacity: 0.25,\n\t        transparent: true\n\t      }));\n\t      plane.visible = false;\n\t      getRaycaster = (function(_this) {\n\t        return function() {\n\t          var camera, raycaster, vector;\n\t          camera = window.activeCamera;\n\t          vector = new THREE.Vector3(mouse.x, mouse.y, 0.5).unproject(camera);\n\t          raycaster = new THREE.Raycaster(camera.position, vector.sub(camera.position).normalize());\n\t          return raycaster;\n\t        };\n\t      })(this);\n\t      $container.mousedown((function(_this) {\n\t        return function(e) {\n\t          var element, intersects, raycaster;\n\t          e.preventDefault();\n\t          raycaster = getRaycaster();\n\t          intersects = raycaster.intersectObjects(window.app.scene.children);\n\t          if (intersects.length) {\n\t            element = intersects[0].object;\n\t            if (element._data) {\n\t              _this.editor.selectionManager.select(element._data);\n\t              selectedObject = element;\n\t              selectedObjectPos = selectedObject.position.clone();\n\t              intersects = raycaster.intersectObject(plane);\n\t              return offset.copy(intersects[0].point).sub(plane.position);\n\t            }\n\t          }\n\t        };\n\t      })(this));\n\t      $(window).mouseup((function(_this) {\n\t        return function(e) {\n\t          return selectedObject = false;\n\t        };\n\t      })(this));\n\t      $container.mousemove((function(_this) {\n\t        return function(e) {\n\t          var intersects, pos, posDiff, prop_x, prop_y, raycaster;\n\t          mouse.x = (e.clientX / $container.width()) * 2 - 1;\n\t          mouse.y = -(e.clientY / $container.height()) * 2 + 1;\n\t          if (!selectedObject) {\n\t            return;\n\t          }\n\t          if (!selectedObject._data) {\n\t            return;\n\t          }\n\t          prop_x = _this.tweenTime.getProperty('x', selectedObject._data);\n\t          prop_y = _this.tweenTime.getProperty('y', selectedObject._data);\n\t          raycaster = getRaycaster();\n\t          intersects = raycaster.intersectObject(plane);\n\t          pos = intersects[0].point.sub(offset);\n\t          posDiff = selectedObjectPos.clone().add(pos);\n\t          _this.tweenTime.setValue(prop_x, posDiff.x);\n\t          _this.tweenTime.setValue(prop_y, posDiff.y);\n\t          selectedObject._data._isDirty = true;\n\t          return _this.editor.timeline._isDirty = true;\n\t        };\n\t      })(this));\n\t    }\n\t\n\t    EditorUI.prototype.onMenuCreated = function($el) {\n\t      $el.append('<a class=\"menu-item menu-item--remove\">Remove</a>');\n\t      $el.prepend('<span class=\"menu-item\">Add<div class=\"submenu submenu--add\"></div></span>');\n\t      this.initAdd($el);\n\t      return this.initRemove($el);\n\t    };\n\t\n\t    EditorUI.prototype.initRemove = function($el) {\n\t      var data, selectionManager, self;\n\t      self = this;\n\t      selectionManager = self.editor.selectionManager;\n\t      data = window.tweenTime.data;\n\t      $el.find('.menu-item--remove').click(function(e) {\n\t        var datum, index, item, _i, _len, _ref;\n\t        e.preventDefault();\n\t        _ref = selectionManager.selection;\n\t        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n\t          item = _ref[_i];\n\t          datum = d3.select(item).datum();\n\t          index = data.indexOf(datum);\n\t          if (datum && datum.type && datum.id && index > -1) {\n\t            data.splice(index, 1);\n\t            if (datum.object) {\n\t              datum.object.destroy();\n\t              delete datum.object;\n\t            }\n\t          }\n\t        }\n\t        selectionManager.reset();\n\t        self.editor.render(false, false, true);\n\t      });\n\t    };\n\t\n\t    EditorUI.prototype.initAdd = function($el) {\n\t      var $container, $link, element, element_name, elements, self;\n\t      if (!window.ElementFactory) {\n\t        return;\n\t      }\n\t      $container = $el.find('.submenu--add');\n\t      elements = window.ElementFactory.elements;\n\t      self = this;\n\t      for (element_name in elements) {\n\t        element = elements[element_name];\n\t        $link = $('<a href=\"#\" data-key=\"' + element_name + '\">' + element_name + '</a>');\n\t        $container.append($link);\n\t      }\n\t      $container.find('a').click(function(e) {\n\t        var all_data, current_time, data, id, label, next_id;\n\t        e.preventDefault();\n\t        element_name = $(this).data('key');\n\t        if (ElementFactory.elements[element_name]) {\n\t          all_data = self.tweenTime.data;\n\t          next_id = all_data.length + 1;\n\t          id = \"item\" + next_id;\n\t          label = element_name + \" \" + next_id;\n\t          current_time = self.tweenTime.timer.time[0] / 1000;\n\t          data = {\n\t            isDirty: true,\n\t            id: id,\n\t            label: label,\n\t            type: element_name,\n\t            start: current_time,\n\t            end: current_time + 2,\n\t            collapsed: false,\n\t            properties: ElementFactory.getTypeProperties(element_name)\n\t          };\n\t          self.tweenTime.data.push(data);\n\t          self.editor.timeline._isDirty = true;\n\t        }\n\t      });\n\t    };\n\t\n\t    return EditorUI;\n\t\n\t  })();\n\t}.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ },\n/* 1 */,\n/* 2 */,\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = TweenTime.Editor;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = d3;\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** Editor.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"assets/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 70b1a6600bfa0a9cf61a\n **/","define (require) ->\n  THREE = window.THREE\n  TweenTimeEditor = require 'TweenTime.Editor'\n  d3 = require 'd3'\n\n  window.EditorUI = class EditorUI\n    constructor: () ->\n      @tweenTime = window.tweenTime\n      @editor = new TweenTimeEditor(@tweenTime, {\n        #onMenuCreated: @onMenuCreated,\n        json_replacer: (key, val) ->\n          # filter some circular values\n          if key == 'container' then return undefined\n          if key == 'parent' then return undefined\n          if key == 'children' then return undefined\n          if key == 'object' then return undefined\n          if key == 'classObject' then return undefined\n          return val\n      })\n      @onMenuCreated($('.timeline__menu'))\n\n\n      $container = $(window.app.containerWebgl)\n      offset = new THREE.Vector3()\n      projector = new THREE.Projector()\n      mouse = new THREE.Vector2()\n      selectedObject = false\n      selectedObjectPos = new THREE.Vector3()\n\n      plane = new THREE.Mesh(\n        new THREE.PlaneBufferGeometry( 3000, 2000, 8, 8 ),\n        new THREE.MeshBasicMaterial( { color: 0xff0000, opacity: 0.25, transparent: true } )\n      )\n      plane.visible = false\n      #window.app.scene.add( plane )\n\n      getRaycaster = () =>\n        camera = window.activeCamera\n        vector = new THREE.Vector3( mouse.x, mouse.y, 0.5 ).unproject( camera )\n        raycaster = new THREE.Raycaster(camera.position, vector.sub( camera.position ).normalize())\n        return raycaster\n\n      $container.mousedown (e) =>\n        e.preventDefault()\n        raycaster = getRaycaster()\n        intersects = raycaster.intersectObjects( window.app.scene.children )\n\n        if intersects.length\n          element = intersects[0].object\n          if element._data\n            @editor.selectionManager.select(element._data)\n            selectedObject = element\n            selectedObjectPos = selectedObject.position.clone()\n\n            intersects = raycaster.intersectObject(plane)\n            offset.copy(intersects[ 0 ].point).sub(plane.position)\n      $(window).mouseup (e) =>\n        selectedObject = false\n\n      $container.mousemove (e) =>\n        mouse.x = ( e.clientX / $container.width() ) * 2 - 1\n        mouse.y = -( e.clientY / $container.height() ) * 2 + 1\n\n        if !selectedObject then return\n        if !selectedObject._data then return\n        prop_x = @tweenTime.getProperty('x', selectedObject._data)\n        prop_y = @tweenTime.getProperty('y', selectedObject._data)\n\n        raycaster = getRaycaster()\n        intersects = raycaster.intersectObject( plane )\n        pos = intersects[ 0 ].point.sub( offset )\n\n        posDiff = selectedObjectPos.clone().add(pos)\n\n        @tweenTime.setValue(prop_x, posDiff.x)\n        @tweenTime.setValue(prop_y, posDiff.y)\n        selectedObject._data._isDirty = true\n        @editor.timeline._isDirty = true\n\n\n    onMenuCreated: ($el) =>\n      $el.append('<a class=\"menu-item menu-item--remove\">Remove</a>')\n      $el.prepend('<span class=\"menu-item\">Add<div class=\"submenu submenu--add\"></div></span>')\n\n      @initAdd($el)\n      @initRemove($el)\n\n    initRemove: ($el) =>\n      self = this\n      selectionManager = self.editor.selectionManager\n      data = window.tweenTime.data\n      $el.find('.menu-item--remove').click (e) ->\n        e.preventDefault()\n        for item in selectionManager.selection\n          # only remove full objects.\n          datum = d3.select(item).datum()\n          index = data.indexOf(datum)\n          if datum && datum.type && datum.id && index > -1\n            data.splice(index, 1)\n            # also remove the three.js object\n            if datum.object\n              datum.object.destroy()\n              delete datum.object\n\n        selectionManager.reset()\n        self.editor.render(false, false, true)\n        return\n      return\n\n    initAdd: ($el) =>\n      if !window.ElementFactory then return\n      $container = $el.find('.submenu--add')\n      elements = window.ElementFactory.elements\n      self = this\n\n      for element_name, element of elements\n        $link = $('<a href=\"#\" data-key=\"' + element_name + '\">' + element_name + '</a>')\n        $container.append($link)\n\n      $container.find('a').click (e) ->\n        e.preventDefault()\n        element_name = $(this).data('key')\n        if ElementFactory.elements[element_name]\n          all_data = self.tweenTime.data\n          next_id = all_data.length + 1\n          id = \"item\" + next_id\n          label = element_name + \" \" + next_id\n          current_time = self.tweenTime.timer.time[0] / 1000\n          data =\n            isDirty: true\n            id: id\n            label: label\n            type: element_name\n            start: current_time\n            end: current_time + 2\n            collapsed: false\n            #properties: []\n            #options: window.ElementFactory.elements[element_name].default_attributes()\n            #properties: window.ElementFactory.elements[element_name].default_properties(current_time)\n            properties: ElementFactory.getTypeProperties(element_name)\n\n          self.tweenTime.data.push(data)\n          self.editor.timeline._isDirty = true\n        return\n      return\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/scripts/app/EditorUI.coffee\n **/","module.exports = TweenTime.Editor;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"TweenTime.Editor\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = d3;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"d3\"\n ** module id = 4\n ** module chunks = 0\n **/"],"sourceRoot":""}